<!-- ====================== METRICHE DASHBOARD ====================== -->
<div class="row g-4">

  <!-- Clienti totali -->
  <div class="col-12 col-md-2">
    <div class="card metric-card text-center p-3 h-100 shadow-sm border-0 rounded-4" style="height: 200px;">
      <div class="card-body d-flex flex-column justify-content-center">
        <i class="bi bi-people-fill fs-1 text-primary mb-2"></i>
        <h6 class="text-muted">Clienti Totali</h6>
        <h2 class="fw-bold mb-0 text-dark">
          {{ clienti|length if clienti is defined else 0 }}
        </h2>
      </div>
    </div>
  </div>

  <!-- Clienti Nuovi -->
  <div class="col-12 col-md-2">
    <div class="card metric-card text-center p-3 h-100 shadow-sm border-0 rounded-4" style="height: 200px;">
      <div class="card-body d-flex flex-column justify-content-center">
        <i class="bi bi-person-plus-fill fs-1 text-success mb-2"></i>
        <h6 class="text-muted">Clienti Nuovi (30gg)</h6>
        <h2 class="fw-bold mb-0 text-dark">
          {{ clienti_nuovi|length if clienti_nuovi is defined else 0 }}
        </h2>
      </div>
    </div>
  </div>

  <!-- Clienti Bloccati -->
  <div class="col-12 col-md-2">
    <div class="card metric-card text-center p-3 h-100 shadow-sm border-0 rounded-4" style="height: 200px;">
      <div class="card-body d-flex flex-column justify-content-center">
        <i class="bi bi-person-x-fill fs-1 text-danger mb-2"></i>
        <h6 class="text-muted">Clienti Bloccati</h6>
        <h2 class="fw-bold mb-0 text-danger">
          {{ clienti_bloccati|length if clienti_bloccati is defined else 0 }}
        </h2>
      </div>
    </div>
  </div>

  <!-- Clienti Inattivi -->
  <div class="col-12 col-md-2">
    <div class="card metric-card text-center p-3 h-100 shadow-sm border-0 rounded-4" style="height: 200px;">
      <div class="card-body d-flex flex-column justify-content-center">
        <i class="bi bi-person-dash-fill fs-1 text-secondary mb-2"></i>
        <h6 class="text-muted">Clienti Inattivi</h6>
        <h2 class="fw-bold mb-0 text-secondary">
          {{ clienti_inattivi|length if clienti_inattivi is defined else 0 }}
        </h2>
      </div>
    </div>
  </div>

  <!-- Fatturato totale -->
  <div class="col-12 col-md-2">
    <div class="card metric-card text-center p-3 h-100 shadow-sm border-0 rounded-4" style="height: 200px;">
      <div class="card-body d-flex flex-column justify-content-center">
        <i class="bi bi-cash-stack fs-1 text-success mb-2"></i>
        <h6 class="text-muted">Fatturato Totale</h6>
        <h2 class="fw-bold mb-0 text-dark">
          € {{ clienti|map(attribute='fatturato_totale')|sum|default(0)|float|round(2) }}
        </h2>
      </div>
    </div>
  </div>

  <!-- Media per cliente -->
  <div class="col-12 col-md-2">
    <div class="card metric-card text-center p-3 h-100 shadow-sm border-0 rounded-4" style="height: 200px;">
      <div class="card-body d-flex flex-column justify-content-center">
        <i class="bi bi-bar-chart-line fs-1 text-info mb-2"></i>
        <h6 class="text-muted">Media per Cliente</h6>
        {% set totale = clienti|map(attribute='fatturato_totale')|sum %}
        <h2 class="fw-bold mb-0 text-dark">
          € {{ (totale / (clienti|length) if clienti|length > 0 else 0) | round(2) }}
        </h2>
      </div>
    </div>
  </div>

  <!-- Mini grafico fatturato per zona -->
  <div class="col-12 col-md-3">
    <div class="card metric-card text-center p-3 h-100 shadow-sm border-0 rounded-4" style="height: 200px;">
      <div class="card-body d-flex flex-column justify-content-center">
        <i class="bi bi-bar-chart-fill fs-1 text-warning mb-2"></i>
        <h6 class="text-muted">Fatturato per Zona</h6>
        <canvas id="miniFatturatoZonaChart" height="80"></canvas>
      </div>
    </div>
  </div>

  <!-- Crescita mensile -->
  <div class="col-12 col-md-3">
    <div class="card metric-card text-center p-3 h-100 shadow-sm border-0 rounded-4" style="height: 200px;">
      <div class="card-body d-flex flex-column justify-content-center">
        <i class="bi bi-graph-up-arrow fs-1 mb-2" id="trendIcon"></i>
        <h6 class="text-muted">Crescita Mensile</h6>
        <h2 id="trendPercent" class="fw-bold mb-0 text-dark">--</h2>
        <p class="text-muted small mb-0">vs mese precedente</p>
      </div>
    </div>
  </div>
</div>
