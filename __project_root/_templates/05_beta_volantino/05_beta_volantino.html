{% extends "01_base.html" %}

{% block title %}BETA Volantino - Gestionale Horeca{% endblock %}

{% block content %}

<h1 class="mb-4">üß™ BETA ‚Äì Editor Volantino (Stile InPublish)</h1>

<div class="row">

  <!-- TOOLBAR LATERALE -->
  <div class="col-md-3">

    <!-- Nome volantino -->
    <div class="card mb-3 shadow-sm">
      <div class="card-header fw-bold">
        <i class="bi bi-card-text me-1"></i> Nome volantino
      </div>
      <div class="card-body">
        <input type="text" id="volantino-nome" class="form-control form-control-sm"
               placeholder="Es. VOLANTINO ITTICO NOVEMBRE"
               value="{{ nome_volantino or '' }}">
      </div>
    </div>

    <!-- Pagine -->
    <div class="card mb-3 shadow-sm">
      <div class="card-header fw-bold d-flex justify-content-between align-items-center">
        <span><i class="bi bi-journal-text me-1"></i> Pagine</span>
      </div>
      <div class="card-body">
        <div id="lista-pagine" class="mb-2"></div>
        <div class="d-grid gap-2">
          <button class="btn btn-primary btn-sm" id="aggiungi-pagina">
            ‚ûï Aggiungi pagina
          </button>
          <button class="btn btn-outline-primary btn-sm" id="duplica-pagina">
            üìÑ Duplica pagina corrente
          </button>
        </div>
      </div>
    </div>

    <!-- Layout griglia -->
    <div class="card mb-3 shadow-sm">
      <div class="card-header fw-bold">
        <i class="bi bi-grid-3x3-gap-fill me-1"></i> Layout griglia pagina
      </div>
      <div class="card-body">
        <button class="btn btn-outline-primary w-100 mb-2" data-grid="2x3">Griglia 2 √ó 3</button>
        <button class="btn btn-outline-primary w-100 mb-2" data-grid="3x3">Griglia 3 √ó 3</button>
        <button class="btn btn-outline-primary w-100 mb-2" data-grid="4x3">Griglia 4 √ó 3</button>
      </div>
    </div>

    <!-- Formato celle -->
    <div class="card mb-3 shadow-sm">
      <div class="card-header fw-bold">
        <i class="bi bi-bounding-box-circles me-1"></i> Formato cella selezionata
      </div>
      <div class="card-body d-grid gap-2">
        <button class="btn btn-outline-secondary btn-sm" data-cell-size="1x1">1 √ó 1 (normale)</button>
        <button class="btn btn-outline-secondary btn-sm" data-cell-size="2x1">2 √ó 1 (larga)</button>
        <button class="btn btn-outline-secondary btn-sm" data-cell-size="1x2">1 √ó 2 (alta)</button>
        <button class="btn btn-outline-secondary btn-sm" data-cell-size="2x2">2 √ó 2 (grande)</button>
      </div>
    </div>

    <!-- Stile prezzo -->
    <div class="card mb-3 shadow-sm">
      <div class="card-header fw-bold">
        <i class="bi bi-tag-fill me-1"></i> Stile prezzo
      </div>
      <div class="card-body d-grid gap-2">
        <button class="btn btn-warning btn-sm" data-price-style="yellow">Cartellino giallo</button>
        <button class="btn btn-danger btn-sm" data-price-style="red">Cartellino rosso</button>
        <button class="btn btn-info btn-sm" data-price-style="blue">Cartellino blu</button>
        <button class="btn btn-outline-secondary btn-sm" data-price-style="base">Semplice</button>
      </div>
    </div>

    <!-- Azioni globali -->
    <div class="card shadow-sm">
      <div class="card-header fw-bold"><i class="bi bi-tools me-1"></i> Azioni</div>
      <div class="card-body d-grid gap-2">
        <button class="btn btn-outline-secondary btn-sm" id="duplica-cella">üìÑ Duplica cella selezionata</button>
        <button class="btn btn-outline-danger btn-sm" id="elimina-cella">üóëÔ∏è Elimina cella selezionata</button>
        <hr>
        <button class="btn btn-outline-primary w-100 mb-2" id="save-layout">üíæ Salva Volantino</button>
        <button class="btn btn-outline-dark w-100" id="export-pdf">üìÑ Esporta PDF</button>
      </div>
    </div>

  </div>

  <!-- AREA PAGINE -->
  <div class="col-md-9">
    <div id="pagine-container" style="width: 800px; margin:auto;"></div>
  </div>

</div>

<!-- ==========================================================
     MODAL EDITOR CELLA
========================================================== -->
<div class="modal fade" id="cellEditorModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">‚úèÔ∏è Modifica box prodotto</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">

        <div class="row g-3">

          <!-- IMMAGINE -->
          <div class="col-md-5">
            <label class="form-label small text-muted">Immagine prodotto</label>

            <div id="modal-image-preview"
                 class="border rounded d-flex align-items-center justify-content-center mb-2 ratio ratio-4x3 bg-light"
                 style="overflow:hidden; cursor:pointer;">
              <span class="text-muted small">Clicca per caricare immagine</span>
            </div>

            <button type="button" id="modal-change-image"
                    class="btn btn-outline-secondary btn-sm w-100">üñºÔ∏è Cambia immagine</button>

            <input type="file" id="modal-image-input" class="d-none" accept="image/*">
          </div>

          <!-- CONTENUTI -->
          <div class="col-md-7">

            <div class="mb-2">
              <label class="form-label small">Nome prodotto</label>
              <input type="text" id="modal-title" class="form-control form-control-sm">
            </div>

            <div class="mb-2">
              <label class="form-label small">Descrizione</label>
              <textarea id="modal-desc" class="form-control form-control-sm" rows="3"></textarea>
            </div>

            <div class="row g-2 mb-2">
              <div class="col-6">
                <label class="form-label small">Prezzo</label>
                <input type="text" id="modal-price" class="form-control form-control-sm">
              </div>
              <div class="col-6">
                <label class="form-label small">Stile prezzo</label>
                <select id="modal-price-style" class="form-select form-select-sm">
                  <option value="base">Semplice</option>
                  <option value="yellow">Cartellino giallo</option>
                  <option value="red">Cartellino rosso</option>
                  <option value="blue">Cartellino blu</option>
                </select>
              </div>
            </div>

            <div class="row g-2">
              <div class="col-6">
                <label class="form-label small">Layout box</label>
                <select id="modal-layout" class="form-select form-select-sm">
                  <option value="image-top">Immagine sopra</option>
                  <option value="image-left">Immagine a sinistra</option>
                  <option value="full-image-price">Immagine piena + prezzo</option>
                </select>
              </div>

              <div class="col-6">
                <label class="form-label small">Allineamento testo</label>
                <select id="modal-align" class="form-select form-select-sm">
                  <option value="start">Sinistra</option>
                  <option value="center">Centro</option>
                  <option value="end">Destra</option>
                </select>
              </div>
            </div>

          </div>

        </div>

      </div>

      <div class="modal-footer">
        <button class="btn btn-outline-secondary" data-bs-dismiss="modal">Annulla</button>
        <button class="btn btn-primary" id="modal-save">üíæ Salva box</button>
      </div>

    </div>
  </div>
</div>

{% endblock %}

{% block scripts %}
{{ super() }}

<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/html2canvas"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {

  let pagine = [];
  let paginaCorrente = 0;
  let cellaSelezionata = null;

  const pagineContainer = document.getElementById("pagine-container");
  const listaPagine = document.getElementById("lista-pagine");
  const inputNome = document.getElementById("volantino-nome");

  /* ================================
     MODAL HANDLER
  ================================ */
  const cellEditorModalEl = document.getElementById("cellEditorModal");
  const cellEditorModal = new bootstrap.Modal(cellEditorModalEl);

  const modalImagePreview = document.getElementById("modal-image-preview");
  const modalChangeImage = document.getElementById("modal-change-image");
  const modalImageInput = document.getElementById("modal-image-input");

  const modalTitle = document.getElementById("modal-title");
  const modalDesc  = document.getElementById("modal-desc");
  const modalPrice = document.getElementById("modal-price");

  const modalPriceStyle = document.getElementById("modal-price-style");
  const modalLayout     = document.getElementById("modal-layout");
  const modalAlign      = document.getElementById("modal-align");

  const modalSave       = document.getElementById("modal-save");

  let modalImageData = "";

  function setModalImage(src) {
    modalImageData = src || "";
    if (!src) {
      modalImagePreview.innerHTML =
        `<span class="text-muted small">Clicca per caricare immagine</span>`;
    } else {
      modalImagePreview.innerHTML =
        `<img src="${src}" style="width:100%; height:100%; object-fit:cover;">`;
    }
  }

  modalImagePreview.addEventListener("click", () => modalChangeImage.click());
  modalChangeImage.addEventListener("click", () => modalImageInput.click());
  modalImageInput.addEventListener("change", e => {
    const file = e.target.files[0];
    if (!file) return;
    const r = new FileReader();
    r.onload = () => setModalImage(r.result);
    r.readAsDataURL(file);
  });

  /* ==========================================================
     HELPERS
  ========================================================== */
  function attachImageUpload(box) {
    box.addEventListener("click", () => {
      const input = document.createElement("input");
      input.type = "file";
      input.accept = "image/*";

      input.onchange = (e) => {
        const file = e.target.files[0];
        if (!file) return;

        const r = new FileReader();
        r.onload = () => {
          box.innerHTML =
            `<img src="${r.result}" style="width:100%; height:100%; object-fit:cover;">`;
        };
        r.readAsDataURL(file);
      };

      input.click();
    });
  }

  /* ==========================================================
     CREAZIONE PAGINA
  ========================================================== */
  function creaPagina(cols = 3) {
    const page = document.createElement("div");
    page.classList.add("pagina-volantino");
    page.dataset.cols = cols;

    page.innerHTML = `
      <div class="page-header img-drop">
        <span class="small text-muted">Clicca per inserire header</span>
      </div>

      <div class="page-grid"></div>

      <div class="page-footer img-drop">
        <span class="small text-muted">Clicca per inserire footer</span>
      </div>
    `;

    const header = page.querySelector(".page-header");
    const footer = page.querySelector(".page-footer");
    const grid = page.querySelector(".page-grid");

    attachImageUpload(header);
    attachImageUpload(footer);

    grid.style.display = "grid";
    grid.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
    grid.style.gridAutoRows = "1fr";
    grid.style.gap = "10px";

    Sortable.create(grid, {
      animation: 150,
      ghostClass: "sortable-ghost"
    });

    return page;
  }

  function mostraPaginaCorrente() {
    pagineContainer.innerHTML = "";
    pagineContainer.appendChild(pagine[paginaCorrente]);
  }

  function aggiornaListaPagine() {
    listaPagine.innerHTML = "";

    pagine.forEach((_, i) => {
      const btn = document.createElement("button");
      btn.classList.add("btn", "btn-sm", "w-100", "mb-2");
      btn.innerText = "Pagina " + (i + 1);

      if (i === paginaCorrente) btn.classList.add("btn-primary");
      else btn.classList.add("btn-outline-primary");

      btn.onclick = () => {
        paginaCorrente = i;
        mostraPaginaCorrente();
        aggiornaListaPagine();
      };

      listaPagine.appendChild(btn);
    });
  }

  /* ==========================================================
     CELLE
  ========================================================== */
  function applyCellSize(cell) {
    const c = parseInt(cell.dataset.colspan || "1");
    const r = parseInt(cell.dataset.rowspan || "1");
    cell.style.gridColumn = `span ${c}`;
    cell.style.gridRow = `span ${r}`;
  }

  function applyPriceStyle(cell) {
    const price = cell.querySelector(".prezzo");
    if (!price) return;

    price.classList.remove(
      "prezzo-base",
      "prezzo-yellow",
      "prezzo-red",
      "prezzo-blue"
    );

    price.classList.add("prezzo-" + (cell.dataset.priceStyle || "base"));
  }

  function applyTextAlign(cell) {
    const box = cell.querySelector(".testo-box");
    if (!box) return;
    box.classList.remove("text-start", "text-center", "text-end");

    const a = cell.dataset.textAlign;
    if (a === "center") box.classList.add("text-center");
    else if (a === "end") box.classList.add("text-end");
    else box.classList.add("text-start");
  }

  function applyLayout(cell) {
    const layout = cell.dataset.layout || "image-top";
    cell.classList.remove(
      "cella-layout-image-top",
      "cella-layout-image-left",
      "cella-layout-full-image-price"
    );
    cell.classList.add("cella-layout-" + layout);
  }

  function initCellaEvents(cell) {
    cell.addEventListener("click", (e) => {
      e.stopPropagation();
      selezionaCella(cell);
      apriEditorCella(cell);
    });
  }

  function creaCella() {
    const cell = document.createElement("div");

    cell.classList.add("cella-prodotto");
    cell.dataset.colspan = "1";
    cell.dataset.rowspan = "1";
    cell.dataset.priceStyle = "base";
    cell.dataset.layout = "image-top";
    cell.dataset.textAlign = "start";

    cell.innerHTML = `
      <div class="cella-inner">
        <div class="img-box border mb-1 bg-light d-flex align-items-center justify-content-center"
             style="height:120px; overflow:hidden;">
          <span class="text-muted small">Clicca per modificare</span>
        </div>

        <div class="testo-box text-start">
          <div class="titolo fw-bold small mb-1">TITOLO PRODOTTO</div>
          <div class="descrizione small text-muted mb-1">Descrizione prodotto</div>
          <div class="prezzo text-success fw-bold prezzo-base">‚Ç¨ 0,00</div>
        </div>
      </div>
    `;

    applyCellSize(cell);
    applyPriceStyle(cell);
    applyLayout(cell);
    applyTextAlign(cell);

    initCellaEvents(cell);
    return cell;
  }

  function selezionaCella(c) {
    document.querySelectorAll(".cella-prodotto").forEach((x) =>
      x.classList.remove("cella-selezionata")
    );
    c.classList.add("cella-selezionata");
    cellaSelezionata = c;
  }

  document.addEventListener("click", () => {
    document
      .querySelectorAll(".cella-prodotto")
      .forEach((x) => x.classList.remove("cella-selezionata"));
    cellaSelezionata = null;
  });

  /* ==========================================================
     APRI MODAL CELLA
  ========================================================== */
  function apriEditorCella(cell) {
    cellaSelezionata = cell;

    modalTitle.value = cell.querySelector(".titolo")?.innerText || "";
    modalDesc.value = cell.querySelector(".descrizione")?.innerText || "";
    modalPrice.value = cell.querySelector(".prezzo")?.innerText || "";

    modalPriceStyle.value = cell.dataset.priceStyle;
    modalLayout.value = cell.dataset.layout;
    modalAlign.value = cell.dataset.textAlign;

    const img = cell.querySelector(".img-box img")?.src || "";
    setModalImage(img);

    cellEditorModal.show();
  }

  /* ==========================================================
     SALVA MODIFICHE MODAL
  ========================================================== */
  modalSave.addEventListener("click", () => {
    if (!cellaSelezionata) return;

    const titolo = modalTitle.value.trim();
    const descr = modalDesc.value.trim();
    const prezzo = modalPrice.value.trim() || "‚Ç¨ 0,00";

    cellaSelezionata.querySelector(".titolo").innerText = titolo;
    cellaSelezionata.querySelector(".descrizione").innerText = descr;
    cellaSelezionata.querySelector(".prezzo").innerText = prezzo;

    cellaSelezionata.dataset.priceStyle = modalPriceStyle.value;
    cellaSelezionata.dataset.layout = modalLayout.value;
    cellaSelezionata.dataset.textAlign = modalAlign.value;

    applyPriceStyle(cellaSelezionata);
    applyLayout(cellaSelezionata);
    applyTextAlign(cellaSelezionata);

    const imgBox = cellaSelezionata.querySelector(".img-box");
    if (modalImageData) {
      imgBox.innerHTML =
        `<img src="${modalImageData}" style="width:100%; height:100%; object-fit:cover;">`;
    }

    cellEditorModal.hide();
  });

  /* ==========================================================
     TOOLBAR FUNZIONI CELLE
  ========================================================== */
  document.querySelectorAll("[data-cell-size]").forEach((btn) => {
    btn.addEventListener("click", () => {
      if (!cellaSelezionata) return alert("Seleziona una cella");

      const [c, r] = btn.dataset.cellSize.split("x").map(Number);
      cellaSelezionata.dataset.colspan = c;
      cellaSelezionata.dataset.rowspan = r;

      applyCellSize(cellaSelezionata);
    });
  });

  document.querySelectorAll("[data-price-style]").forEach((btn) => {
    btn.addEventListener("click", () => {
      if (!cellaSelezionata) return alert("Seleziona una cella");
      cellaSelezionata.dataset.priceStyle = btn.dataset.priceStyle;
      applyPriceStyle(cellaSelezionata);
    });
  });

  document.getElementById("duplica-cella").addEventListener("click", () => {
    if (!cellaSelezionata) return alert("Seleziona una cella");
    const clone = cellaSelezionata.cloneNode(true);
    initCellaEvents(clone);
    cellaSelezionata.parentElement.appendChild(clone);
  });

  document.getElementById("elimina-cella").addEventListener("click", () => {
    if (!cellaSelezionata) return alert("Seleziona una cella");
    cellaSelezionata.remove();
    cellaSelezionata = null;
  });

  /* ==========================================================
     GRIGLIA
  ========================================================== */
  document.querySelectorAll("[data-grid]").forEach((btn) => {
    btn.addEventListener("click", () => {
      const [cols, rows] = btn.dataset.grid.split("x").map(Number);

      const page = pagine[paginaCorrente];
      const grid = page.querySelector(".page-grid");

      grid.innerHTML = "";
      grid.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
      page.dataset.cols = cols;

      for (let i = 0; i < cols * rows; i++) grid.appendChild(creaCella());

      Sortable.create(grid, {
        animation: 150,
        ghostClass: "sortable-ghost"
      });
    });
  });

  /* ==========================================================
     AGGIUNGI / DUPLICA PAGINA
  ========================================================== */
  document.getElementById("aggiungi-pagina").addEventListener("click", () => {
    const p = creaPagina(3);
    pagine.push(p);
    paginaCorrente = pagine.length - 1;
    mostraPaginaCorrente();
    aggiornaListaPagine();
  });

  document.getElementById("duplica-pagina").addEventListener("click", () => {
    const originale = pagine[paginaCorrente];
    const clone = originale.cloneNode(true);

    const header = clone.querySelector(".page-header");
    const footer = clone.querySelector(".page-footer");
    attachImageUpload(header);
    attachImageUpload(footer);

    const grid = clone.querySelector(".page-grid");
    Sortable.create(grid, { animation: 150 });

    clone.querySelectorAll(".cella-prodotto").forEach(initCellaEvents);

    pagine.push(clone);
    paginaCorrente = pagine.length - 1;
    mostraPaginaCorrente();
    aggiornaListaPagine();
  });

  /* ==========================================================
     SALVATAGGIO VOLANTINO
  ========================================================== */
  document.getElementById("save-layout").addEventListener("click", () => {
    const data = pagine.map((page) => {
      const grid = page.querySelector(".page-grid");

      const headerImg = page.querySelector(".page-header img")?.src || "";
      const footerImg = page.querySelector(".page-footer img")?.src || "";
      const cols = page.dataset.cols;

      const cells = Array.from(grid.querySelectorAll(".cella-prodotto")).map(
        (c) => ({
          img: c.querySelector(".img-box img")?.src || "",
          titolo: c.querySelector(".titolo")?.innerText || "",
          descrizione: c.querySelector(".descrizione")?.innerText || "",
          prezzo: c.querySelector(".prezzo")?.innerText || "",
          colSpan: c.dataset.colspan,
          rowSpan: c.dataset.rowspan,
          priceStyle: c.dataset.priceStyle,
          layout: c.dataset.layout,
          textAlign: c.dataset.textAlign
        })
      );

      return { cols, headerImg, footerImg, cells };
    });

    fetch("/salva-volantino-beta", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        id: {{ volantino_id or "null" }},
        nome: inputNome.value,
        layout: data
      })
    })
      .then((r) => r.json())
      .then(() => alert("Volantino salvato!"));
  });

  /* ==========================================================
     CARICA LAYOUT SALVATO
  ========================================================== */
  {% if layout_json %}
    const salvato = {{ layout_json | safe }};

    salvato.forEach((pageData) => {
      const page = creaPagina(pageData.cols);
      const grid = page.querySelector(".page-grid");

      if (pageData.headerImg)
        page.querySelector(".page-header").innerHTML =
          `<img src="${pageData.headerImg}" style="width:100%; height:100%; object-fit:cover;">`;

      if (pageData.footerImg)
        page.querySelector(".page-footer").innerHTML =
          `<img src="${pageData.footerImg}" style="width:100%; height:100%; object-fit:cover;">`;

      (pageData.cells || []).forEach((c) => {
        const cell = creaCella();

        if (c.img)
          cell.querySelector(".img-box").innerHTML =
            `<img src="${c.img}" style="width:100%; height:100%; object-fit:cover;">`;

        cell.querySelector(".titolo").innerText = c.titolo;
        cell.querySelector(".descrizione").innerText = c.descrizione;
        cell.querySelector(".prezzo").innerText = c.prezzo;

        cell.dataset.colspan = c.colSpan;
        cell.dataset.rowspan = c.rowSpan;
        cell.dataset.priceStyle = c.priceStyle;
        cell.dataset.layout = c.layout;
        cell.dataset.textAlign = c.textAlign;

        applyCellSize(cell);
        applyPriceStyle(cell);
        applyLayout(cell);
        applyTextAlign(cell);

        grid.appendChild(cell);
      });

      pagine.push(page);
    });
  {% endif %}

  if (pagine.length === 0) pagine.push(creaPagina(3));

  mostraPaginaCorrente();
  aggiornaListaPagine();

  /* ==========================================================
     ESPORTA PDF
  ========================================================== */
  document.getElementById("export-pdf").addEventListener("click", async () => {
    const pdf = new jspdf.jsPDF("p", "px", [800, 1100]);

    for (let i = 0; i < pagine.length; i++) {
      if (i > 0) pdf.addPage();
      paginaCorrente = i;
      mostraPaginaCorrente();

      const canvas = await html2canvas(pagine[i], { scale: 2 });
      pdf.addImage(canvas.toDataURL("image/png"), "PNG", 0, 0, 800, 1100);
    }

    pdf.save((inputNome.value || "volantino") + ".pdf");
  });
});
</script>

<style>
/* --- Stili base pagina --- */
.pagina-volantino {
  width: 800px;
  height: 1100px;
  background: #fff;
  border: 1px solid #ccc;
  box-shadow: 0 0 10px rgba(0,0,0,0.15);
  display: grid;
  grid-template-rows: auto 1fr auto;
  padding: 10px;
  margin-bottom: 40px;
}

.page-header,
.page-footer {
  height: 80px;
  border: 1px dashed #aaa;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  overflow: hidden;
}

.page-grid {
  min-height: 0;
}

/* --- Celle --- */
.cella-prodotto {
  background: #fff;
  border: 1px solid #ddd;
  padding: 6px;
  cursor: pointer;
  transition: box-shadow .15s ease;
}
.cella-prodotto:hover {
  box-shadow: 0 0 8px rgba(0,0,0,0.15);
}
.cella-selezionata {
  outline: 3px solid #007bff;
}

/* --- Layout vari --- */
.cella-layout-image-top .cella-inner { flex-direction: column; }
.cella-layout-image-left .cella-inner { flex-direction: row; }
.cella-layout-image-left .img-box { width: 50%; }
.cella-layout-full-image-price .cella-inner { position: relative; }
.cella-layout-full-image-price .testo-box {
  position: absolute; bottom: 6px; left: 6px; right: 6px; color:white;
  text-shadow:0 0 4px rgba(0,0,0,0.6);
}

/* --- Prezzi --- */
.prezzo-base  { background: transparent; }
.prezzo-yellow{ background: #ffeb3b; padding:3px 5px; border-radius:4px; }
.prezzo-red   { background: #e53935; color:white; padding:3px 5px; border-radius:4px; }
.prezzo-blue  { background: #2196f3; color:white; padding:3px 5px; border-radius:4px; }

/* Ghost sortable */
.sortable-ghost { opacity:.4; }
</style>

{% endblock %}
